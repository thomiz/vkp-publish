<?xml version="1.0" encoding="utf-8"?>
<StructureDefinition xmlns="http://hl7.org/fhir">
  <id value="FlagVFT" />
  <meta>
    <versionId value="5" />
    <lastUpdated value="2017-02-23T13:27:57.942+01:00" />
  </meta>
  <url value="http://ehelse.no/fhir/profiles/vft/FlagVFT" />
  <version value="0.1" />
  <name value="FlagVFT" />
  <status value="draft" />
  <date value="2017-01-04T14:52:21+01:00" />
  <description value="Profile of the Flag Resource to be used in Personal Connected Health in Norway. Adds Severity, category, timestamp, URL and Geoposition to the base http://hl7.org/fhir/StructureDefinition/Flag resource.&#xD;&#xA;" />
  <kind value="resource" />
  <constrainedType value="Flag" />
  <abstract value="false" />
  <base value="http://hl7.org/fhir/StructureDefinition/Flag" />
  <differential>
    <element>
      <path value="Flag" />
    </element>
    <element>
      <path value="Flag.extension" />
      <slicing>
        <discriminator value="url" />
        <rules value="open" />
      </slicing>
    </element>
    <element>
      <path value="Flag.extension" />
      <name value="Severity" />
      <min value="1" />
      <max value="1" />
      <type>
        <code value="Extension" />
        <profile value="http://ehelse.no/fhir/profiles/vft/SeverityValueSet" />
      </type>
      <binding>
        <strength value="required" />
        <description value="red|yellow|green|greenwithmessage|notreported" />
      </binding>
    </element>
    <element>
      <path value="Flag.extension" />
      <name value="timestamp" />
      <short value="timestampExtention" />
      <definition value="Simple timpestamp for when the Flag was generated" />
      <min value="1" />
      <max value="1" />
      <type>
        <code value="Extension" />
        <profile value="http://ehelse.no/fhir/extentions/StructureDefinition/Timestamp" />
      </type>
    </element>
    <element>
      <path value="Flag.extension" />
      <name value="URL" />
      <short value="Url for the alarm" />
      <definition value="Url to open the alarm in a browser" />
      <max value="1" />
      <type>
        <code value="Extension" />
        <profile value="http://ehelse.no/fhir/extentions/StructureDefinition/URL" />
      </type>
    </element>
    <element>
      <path value="Flag.extension" />
      <name value="geopositions" />
      <type>
        <code value="Extension" />
        <profile value="http://ehelse.no/fhir/profiles/vft/GeoPosition" />
      </type>
    </element>
    <element>
      <path value="Flag.extension.extension" />
      <slicing>
        <discriminator value="url" />
        <rules value="open" />
      </slicing>
    </element>
    <element>
      <path value="Flag.extension.extension" />
      <name value="PositionTimestamp" />
      <short value="Timestamp of the position measurement" />
      <definition value="Timestamp of the position measurement" />
      <max value="1" />
      <type>
        <code value="Extension" />
        <profile value="http://ehelse.no/fhir/extentions/StructureDefinition/Timestamp" />
      </type>
    </element>
    <element>
      <path value="Flag.extension.extension" />
      <name value="velocityms" />
      <short value="Velocity" />
      <definition value="Velocity annotated in meter per second" />
      <max value="1" />
      <type>
        <code value="Extension" />
        <profile value="http://ehelse.no/fhir/extentions/StructureDefinition/Velocityms" />
      </type>
    </element>
    <element>
      <path value="Flag.extension.extension" />
      <name value="DirectionDegrees" />
      <short value="Direction of travel in desimal degrees (DD)" />
      <definition value="Direction of travel in desimal degrees (DD)" />
      <max value="1" />
      <type>
        <code value="Extension" />
        <profile value="http://ehelse.no/fhir/extentions/StructureDefinition/DirectionDecimalDegrees" />
      </type>
    </element>
    <element>
      <path value="Flag.extension.extension" />
      <name value="DirectionDegrees" />
      <short value="Base for all elements" />
      <definition value="Optional Extensions Element - found in all resources." />
    </element>
    <element>
      <path value="Flag.extension.identifier" />
      <short value="Unique code or number identifying the location to its users" />
      <definition value="Unique code or number identifying the location to its users." />
      <requirements value="Organization label locations in registries, need to keep track of those." />
      <type>
        <code value="Identifier" />
      </type>
      <mapping>
        <identity value="rim" />
        <map value=".id" />
      </mapping>
      <mapping>
        <identity value="w5" />
        <map value="id" />
      </mapping>
    </element>
    <element>
      <path value="Flag.extension.status" />
      <short value="active | suspended | inactive" />
      <definition value="active | suspended | inactive." />
      <max value="0" />
      <type>
        <code value="code" />
      </type>
      <isModifier value="true" />
      <isSummary value="true" />
      <binding>
        <strength value="required" />
        <description value="Indicates whether the location is still in use." />
        <valueSetReference>
          <reference value="http://hl7.org/fhir/ValueSet/location-status" />
        </valueSetReference>
      </binding>
      <mapping>
        <identity value="rim" />
        <map value=".statusCode" />
      </mapping>
      <mapping>
        <identity value="w5" />
        <map value="status" />
      </mapping>
    </element>
    <element>
      <path value="Flag.extension.name" />
      <short value="Name of the location as used by humans" />
      <definition value="Name of the location as used by humans. Does not need to be unique." />
      <max value="0" />
      <type>
        <code value="string" />
      </type>
      <isSummary value="true" />
      <mapping>
        <identity value="rim" />
        <map value=".name" />
      </mapping>
    </element>
    <element>
      <path value="Flag.extension.description" />
      <short value="Description of the location" />
      <definition value="Description of the Location, which helps in finding or referencing the place." />
      <requirements value="Humans need additional information to verify a correct location has been identified." />
      <max value="0" />
      <type>
        <code value="string" />
      </type>
      <isSummary value="true" />
      <mapping>
        <identity value="rim" />
        <map value=".playingEntity[classCode=PLC determinerCode=INSTANCE].desc" />
      </mapping>
    </element>
    <element>
      <path value="Flag.extension.mode" />
      <short value="instance | kind" />
      <definition value="Indicates whether a resource instance represents a specific location or a class of locations." />
      <requirements value="When using a Location resource for scheduling or orders, we need to be able to refer to a class of Locations instead of a specific Location." />
      <max value="0" />
      <type>
        <code value="code" />
      </type>
      <isModifier value="true" />
      <isSummary value="true" />
      <binding>
        <strength value="required" />
        <description value="Indicates whether a resource instance represents a specific location or a class of locations." />
        <valueSetReference>
          <reference value="http://hl7.org/fhir/ValueSet/location-mode" />
        </valueSetReference>
      </binding>
      <mapping>
        <identity value="rim" />
        <map value=".playingEntity[classCode=PLC].determinerCode" />
      </mapping>
      <mapping>
        <identity value="w5" />
        <map value="class" />
      </mapping>
    </element>
    <element>
      <path value="Flag.extension.type" />
      <short value="Type of function performed" />
      <definition value="Indicates the type of function performed at the location." />
      <max value="0" />
      <type>
        <code value="CodeableConcept" />
      </type>
      <binding>
        <strength value="extensible" />
        <description value="Indicates the type of function performed at the location." />
        <valueSetReference>
          <reference value="http://hl7.org/fhir/ValueSet/v3-ServiceDeliveryLocationRoleType" />
        </valueSetReference>
      </binding>
      <mapping>
        <identity value="rim" />
        <map value=".code" />
      </mapping>
      <mapping>
        <identity value="w5" />
        <map value="class" />
      </mapping>
    </element>
    <element>
      <path value="Flag.extension.telecom" />
      <short value="Contact details of the location" />
      <definition value="The contact details of communication devices available at the location. This can include phone numbers, fax numbers, mobile numbers, email addresses and web sites." />
      <max value="0" />
      <type>
        <code value="ContactPoint" />
      </type>
      <mapping>
        <identity value="rim" />
        <map value=".telecom" />
      </mapping>
    </element>
    <element>
      <path value="Flag.extension.address" />
      <short value="Physical location" />
      <definition value="Physical location." />
      <comments value="This was kept as 0..1 as there is no use property on the address, so wouldn't be able to identify different address types." />
      <requirements value="If locations can be visited, we need to keep track of their address." />
      <max value="0" />
      <type>
        <code value="Address" />
      </type>
      <mapping>
        <identity value="rim" />
        <map value=".addr" />
      </mapping>
    </element>
    <element>
      <path value="Flag.extension.physicalType" />
      <short value="Physical form of the location" />
      <definition value="Physical form of the location, e.g. building, room, vehicle, road." />
      <requirements value="For purposes of showing relevant locations in queries, we need to categorize locations." />
      <max value="0" />
      <type>
        <code value="CodeableConcept" />
      </type>
      <binding>
        <strength value="example" />
        <description value="Physical form of the location" />
        <valueSetReference>
          <reference value="http://hl7.org/fhir/ValueSet/location-physical-type" />
        </valueSetReference>
      </binding>
      <mapping>
        <identity value="rim" />
        <map value=".playingEntity [classCode=PLC].code" />
      </mapping>
      <mapping>
        <identity value="w5" />
        <map value="class" />
      </mapping>
    </element>
    <element>
      <path value="Flag.extension.position" />
      <short value="The absolute geographic location" />
      <definition value="The absolute geographic location of the Location, expressed using the WGS84 datum (This is the same co-ordinate system used in KML)." />
      <requirements value="For mobile applications and automated route-finding knowing the exact location of the Location is required." />
      <max value="1" />
      <type>
        <code value="BackboneElement" />
      </type>
      <mapping>
        <identity value="rim" />
        <map value=".playingEntity [classCode=PLC determinerCode=INSTANCE].positionText" />
      </mapping>
    </element>
    <element>
      <path value="Flag.extension.position.longitude" />
      <short value="Longitude with WGS84 datum" />
      <definition value="Longitude. The value domain and the interpretation are the same as for the text of the longitude element in KML (see notes below)." />
      <min value="1" />
      <max value="1" />
      <type>
        <code value="decimal" />
      </type>
      <mapping>
        <identity value="rim" />
        <map value="(RIM Opted not to map the sub-elements of GPS location, is now an OBS)" />
      </mapping>
    </element>
    <element>
      <path value="Flag.extension.position.latitude" />
      <short value="Latitude with WGS84 datum" />
      <definition value="Latitude. The value domain and the interpretation are the same as for the text of the latitude element in KML (see notes below)." />
      <min value="1" />
      <max value="1" />
      <type>
        <code value="decimal" />
      </type>
      <mapping>
        <identity value="rim" />
        <map value="(RIM Opted not to map the sub-elements of GPS location, is now an OBS)" />
      </mapping>
    </element>
    <element>
      <path value="Flag.extension.position.altitude" />
      <short value="Altitude with WGS84 datum" />
      <definition value="Altitude. The value domain and the interpretation are the same as for the text of the altitude element in KML (see notes below)." />
      <max value="1" />
      <type>
        <code value="decimal" />
      </type>
      <mapping>
        <identity value="rim" />
        <map value="(RIM Opted not to map the sub-elements of GPS location, is now an OBS)" />
      </mapping>
    </element>
    <element>
      <path value="Flag.extension.managingOrganization" />
      <short value="Organization responsible for provisioning and upkeep" />
      <definition value="The organization responsible for the provisioning and upkeep of the location." />
      <comments value="This can also be used as the part of the organization hierarchy where this location provides services. These services can be defined through the HealthcareService resource." />
      <requirements value="Need to know who manages the location." />
      <max value="0" />
      <type>
        <code value="Reference" />
        <profile value="http://hl7.org/fhir/StructureDefinition/Organization" />
      </type>
      <mapping>
        <identity value="rim" />
        <map value=".scopingEntity[classCode=ORG determinerKind=INSTANCE]" />
      </mapping>
    </element>
    <element>
      <path value="Flag.extension.partOf" />
      <short value="Another Location this one is physically part of" />
      <definition value="Another Location which this Location is physically part of." />
      <requirements value="For purposes of location, display and identification, knowing which locations are located within other locations is important." />
      <max value="0" />
      <type>
        <code value="Reference" />
        <profile value="http://hl7.org/fhir/StructureDefinition/Location" />
      </type>
      <mapping>
        <identity value="rim" />
        <map value=".inboundLink[typeCode=PART].source[classCode=SDLC]" />
      </mapping>
    </element>
    <element>
      <path value="Flag.identifier" />
      <name value="alarmid" />
      <short value="Identification of the alarm/flag" />
      <definition value="Uniqe identificatior to idientify the flag. UUID should be used." />
      <min value="1" />
      <max value="1" />
    </element>
  </differential>
</StructureDefinition>