<?xml version="1.0" encoding="UTF-8"?>
<Bundle xmlns="http://hl7.org/fhir" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://hl7.org/fhir ../fhir-all-xsd/fhir-single.xsd">
    <id value="10bb101f-a121-4264-a920-67be9cb82c74" />
    <type value="message" />
    <entry>
        <fullUrl value="urn:uuid:267b18ce-3d37-4581-9baa-6fada338038b" />
        <resource>
            <MessageHeader>
                <id value="1cbdfb97-5859-48a4-8301-d54eab818d68" /> <!-- Autogenerated in the "forsystem" when the message is generated, simple UUID-->
                <text>
                    <status value="generated" />
                    <div xmlns="http://www.w3.org/1999/xhtml"> <!-- Narrative, altså tekst som beskriver MessageHeader, XHTML formatert, kan benyttes til menneskelesbar beskrivelse av ressrusen, ikke obligatorisk-->
                        <p>
                            Velferdsteknologi eksempel
                        </p>
                    </div>
                </text>
                <event>
                    <system value="http://hl7.org/fhir/message-events" /> <!-- Koden er tatt fra predefinert kodeverk for dette i hl7 FHIR, men vi står fritt til å definere vårt eget her -->
                    <code value="MedicationAdministration-Update" />
                </event>
                <receiver>
                    <identifier>
                        <system value="http://ehelse.no/fhir/identifiertypes/HERID" />
                        <value value="87740" /> <!-- Dette er HER-id fra register-web.test.nhn.no for Oslo kommune sin Pleie og omsorgstjeneste -->
                    </identifier>
                    <display value="Pleie- og omsorgstjeneste" />
                </receiver>
                <sender> <!-- Skal identifisere tjenesten for forsystemet slik det er registert i NHN-Adresseregister -->
                    <identifier>
                        <system value="http://ehelse.no/fhir/identifiertypes/HERID" /> 
                        <value value="95341" /> <!-- Dette er HER-id fra register-web.test.nhn.no for tjenesten Velferdpoclev1 (vi kan jo lage andre testtjenester?) -->
                    </identifier>
                    <display value="Velferdpoclev1" />
                </sender>
                <timestamp value="2012-01-04T09:10:14+00:00" />
                <source> <!-- Identifiserer avsenderapplikasjonen -->
                    <name value="Dignio prevent" />
					<software value="Dignio prevent forsystemapplikasjon"/>
					<version value="v2.45"/>
					<contact>
						<system value="email"/>
						<value value="support@dignio.no"/>
					</contact>
                    <endpoint value="http://ehelse.no/fhir/identifiertypes/HERID:95341" /> <!-- Actual source adress or ID, her bør vi bare legge samme HER som i sender -->
                </source>
                <focus>
                    <reference value="urn:uuid:ef91399e-8993-11e7-bb31-be2e44b06b34" />
                    <display value="MedicationAdministration" />
                </focus>
                <focus>
                    <reference value="urn:uuid:e83a9596-8993-11e7-bb31-be2e44b06b34" />
                    <display value="Device" />
                </focus>
            </MessageHeader>
        </resource>
    </entry>
    <entry>
        <fullUrl value="urn:uuid:ef91399e-8993-11e7-bb31-be2e44b06b34" /> <!-- Unik URL som identifiserer ressursen unikt, henger sammen med ressursens logiske id, denne kan genereres av forsystemet og vil aldri endres men ressursen kan oppdateres -->
        <resource>
            <MedicationAdministration>
                <id value="ef91399e-8993-11e7-bb31-be2e44b06b34" /> <!-- ressursens logiske id, forutsetter vi i dette scenariet at forsystemet har rettigheter til å generere slike id'er for fagsystemet, akkurat den forutseningen må etterprøves -->
                <identifier>
                    <system value="http://dignio.no/medisindispenser-event-id" />
                    <value value="c42984fc-8ca8-48d7-8bbf-7fe5503c49a9" /> <!-- Business identifier for hendelsen, kan for eksempel henge sammen med hendelsen generert av medisindispenseren -->
                </identifier>
                <status value="completed" /> <!-- Det bør antakelig lages retningslinjer for hovrdan disse statusmeldingene skal tolkes, det kan til og med være forskjellig for forskjellige typer hendelser -->
                <medicationCodeableConcept> <!-- Hvis dette uansett skal være statisk kan hele coding elementet tas bort -->
                    <text value="Ukjent medisin" />
                </medicationCodeableConcept>
                <subject>
                    <identifier>
                        <system value="http://ehelse.no/fhir/identifiertypes/FNR" />
                        <value value="15076500000" />
                    </identifier>
                    <display value="Bestemor Duck" />
                </subject>
                <effectiveDateTime value="2015-01-15T04:30:00+01:00" />
                <device>
                    <reference value="urn:uuid:e83a9596-8993-11e7-bb31-be2e44b06b34" /> <!-- Forsystemet som sender meldingen må kjenne til id for Devicen, avhengig av måten vi refererer på må forsystemet også vite hva Devicen heter i mottakersystemet -->
                </device>
                <note>
                    <authorReference>
                        <identifier>
                            <system value="http://ehelse.no/fhir/identifiertypes/HPR" />
                            <value value="15076500000" />
                        </identifier>
                        <display value="HPR 15076500000" />
                    </authorReference>
                    <text value="A note about the medication administration, for example how it was handled. " />
                </note>
            </MedicationAdministration>
        </resource>
    </entry>
    <entry>
        <fullUrl value="urn:uuid:e83a9596-8993-11e7-bb31-be2e44b06b34" />
        <resource>
            <Device>
                <id value="e83a9596-8993-11e7-bb31-be2e44b06b34" />
                <identifier>
                    <system value="http://acme-medisindispenser.com/id" />
                    <value value="123345" />
                </identifier>
                <type>
					<coding>
						<system value="http://ehelse.no/fhir/enhetstyper-evik"/>
						<code value="1"/>
						<display value="medisindispenser"/>
					</coding>
                </type>
                <manufacturer value="Acme Medisindispenser" />
            </Device>
        </resource>
    </entry>
</Bundle>